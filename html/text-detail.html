<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#2980b9">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="/css/style.css">
    <title>Telemaque</title>
  </head>
  
  <body>
    <header>
      <h1>Telemaque</h1>
      <nav>
        <a class="nav-back" href="/">
          <img src="/img/arrow-back.svg"> Back
        </a>
      </nav>
    </header>
    <article>
      <h1 id="text-title"><!-- Filled in --></h1>
      <h2 id="text-author"><!-- Filled in --></h2>
      <a id="sentence-link" href="#">Add sentence
      </a>
      <p id="text-description"><!-- Filled in -->
      </p>
    </article>
    <script type="module">
      console.log("Full URL:", window.location.href);
console.log("Search string:", window.location.search);
console.log("Query object:", new URLSearchParams(window.location.search));
      import * as Text from "/js/text.mjs";
      import * as Sentence from "/js/sentence.mjs";

      async function load_text(text_id) {
          if(text_id === undefined) {
              // Nothing to see here. Go home
              return window.location.href = "/";
          }
          
          const text = await Text.get(text_id);
          if(text === null) {
              // Nothing to see here. Go home
              return window.location.href = "/"; 
          }
          
          const $title = document.getElementById("text-title");
          const $author = document.getElementById("text-author");
          const $description = document.getElementById("text-description");
          
          $title.textContent = text.title;
          $author.textContent = text.author;
          $description.textContent = text.description;

          const $sentence_link = document.getElementById("sentence-link");
          $sentence_link.href = `/html/sentence-create?text_id=${text_id}`;
          
          // Make the page title pretty, too
          document.title = `${text.title} | Telemaque`;
          
          console.log({
              event: "TextDetail.LOAD",
              text,
          });
      }

      async function load_sentence(text_id) {
      }
      
      const query = new URLSearchParams(window.location.search);
      const text_id = query.get("text_id");
      console.log("query", query, "text_id", text_id);
      load_text(text_id);
    </script>
  </body>
</html>
